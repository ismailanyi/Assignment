library(tidyverse)
install.packages("tidyverse")
install.packages("corrplot")
install.packages("dplyr")
install.packages("randomForest")
getcwd()
gtcwd()
getwd()
setwd("/home/ismailanyi/Documents/github/Assignment/")
getwd()
list.files()
setwd("5. Predictors of a car sales classification")
ls
list.files()
library(dplyr)
library(randomForest)
install.packages("randomForest")
library(randomForest)
# asd
# Install the packages if you haven't already
install.packages("dplyr")
# Load your dataset (make sure the CSV file is in your working directory)
# Let's assume your file is named 'bmw_sales_data.csv'
car_data <- read.csv("bmw_sales_data.csv")
# It's good practice to inspect the data to see its structure
str(car_data)
summary(car_data)
# --- Data Preparation ---
# The model needs to know that categorical variables are categories (factors in R).
# The target variable 'sales_classification' must also be a factor.
car_data <- car_data %>%
mutate(
transmission = as.factor(transmission),
fuel_type = as.factor(fuel_type),
region = as.factor(region),
model = as.factor(model),
sales_classification = as.factor(sales_classification)
)
View(car_data)
View(car_data)
View(car_data)
install.packages("randomForest")
library(dplyr)
library(randomForest)
car_data <- read.csv("bmw_sales_data.csv")
# It's good practice to inspect the data to see its structure
str(car_data)
summary(car_data)
# --- Data Preparation ---
# The model needs to know that categorical variables are categories (factors in R).
# The target variable 'sales_classification' must also be a factor.
car_data <- car_data %>%
mutate(
transmission = as.factor(transmission),
fuel_type = as.factor(fuel_type),
region = as.factor(region),
model = as.factor(model),
sales_classification = as.factor(sales_classification)
)
View(car_data)
rlang::last_trace()
car_data <- read.csv("bmw_sales_data.csv")
# It's good practice to inspect the data to see its structure
str(car_data)
summary(car_data)
# --- Data Preparation ---
# The model needs to know that categorical variables are categories (factors in R).
# The target variable 'sales_classification' must also be a factor.
car_data <- car_data %>%
mutate(
Transmission = as.factor(Transmission),
fuel_type = as.factor(fuel_type),
region = as.factor(region),
model = as.factor(model),
sales_classification = as.factor(sales_classification)
)
View(car_data)
car_data <- read.csv("bmw_sales_data.csv")
# It's good practice to inspect the data to see its structure
str(car_data)
summary(car_data)
# --- Data Preparation ---
# The model needs to know that categorical variables are categories (factors in R).
# The target variable 'sales_classification' must also be a factor.
car_data <- car_data %>%
mutate(
Transmission = as.factor(Transmission),
Fuel_Type = as.factor(Fuel_Type),
Region = as.factor(Region),
Model = as.factor(Model),
Sales_Classification = as.factor(Sales_Classification)
)
# Let's select the relevant columns for prediction. We will exclude sales_volume
predictors <- car_data %>%
select(Year, Mileage_KM, Engine_Size_L, Price_USD, Transmission, Fuel_Type, Region, Model, Sales_Classification)
# Check for and remove any rows with missing values
predictors <- na.omit(predictors)
# Check the structure of your final "predictors" data frame to be sure
str(predictors)
set.seed(123) # For reproducibility
sales_model <- randomForest(
Sales_Classification ~ .,
data = predictors,
ntree = 500,
importance = TRUE
)
set.seed(123) # For reproducibility
sales_model <- randomForest(
Sales_Classification ~ .,
data = predictors,
ntree = 500,
importance = TRUE
)
# Print the model summary
print(sales_model)
# Create the plot to find the best predictors - THIS IS YOUR KEY RESULT!
varImpPlot(sales_model, main = "Top Predictors for Sales Classification")
# --- Step 1: Extract the Importance Data ---
# (You should already have your 'sales_model' from the previous steps)
importance_scores <- as.data.frame(importance(sales_model))
# Add the variable names from the row names into a new column
importance_scores$Variable <- rownames(importance_scores)
# --- Step 2: Create the Improved Plot ---
# Set up the plotting area to have two plots side-by-side
par(mfrow = c(1, 2), mar = c(5, 4, 4, 2)) # Adjust margins if needed
# --- Plot 1: Mean Decrease in Accuracy ---
# Order the data by MeanDecreaseAccuracy for a clean plot
ordered_accuracy <- importance_scores[order(importance_scores$MeanDecreaseAccuracy), ]
dotchart(
ordered_accuracy$MeanDecreaseAccuracy,
labels = ordered_accuracy$Variable,
main = "Importance by Accuracy",
xlab = "Mean Decrease in Accuracy"
)
# --- Plot 2: Mean Decrease in Gini ---
# Order the data by MeanDecreaseGini
ordered_gini <- importance_scores[order(importance_scores$MeanDecreaseGini), ]
dotchart(
ordered_gini$MeanDecreaseGini,
labels = ordered_gini$Variable,
main = "Importance by Node Purity",
xlab = "Mean Decrease in Gini Impurity"
)
# --- Reset the plotting area to default (optional but good practice) ---
par(mfrow = c(1, 1))
exit
